<html>
  <h1>Tool : stupid Modelica's code formatter for easy diffing</h1>
  <h2>Input</h2>

  <textarea id="inputTxt" style="width: 300px; height: 100px">model A annotation(hello); end modelA;</textarea
  ><br />
  <input type="checkbox" id="removeAnnotation" />
  <label for="removeAnnotation">Remove annotation</label
  ><br />
  <br />
  <button id="execute">Format input</button>
  <h2>Output</h2>
  <textarea id="output" style="width: 90%; height: 200px"></textarea>
  <script>
    const formatModelica = ({ moCode, removeAnnotation }) => {
      const step1 = moCode.replaceAll(/\s+/gis, " ").replaceAll(/\s*,/gi, ",\n");

      console.log("removing annotation ?", removeAnnotation);
      const step2 = removeAnnotation ? step1.replaceAll(/\s+annotation\s*\(.+?\);/gis, ";") : step1;

      const step3 = step2.replaceAll(/\(/gi, "(\n").replaceAll(/\)/gi, "\n)").replaceAll(/\s*; /gi, ";\n");

      return step3;
    };

    document.getElementById("execute").addEventListener("click", () => {
      const inputTxtValue = document.getElementById("inputTxt").value;
      const removeAnnotationValue = document.getElementById("removeAnnotation").checked;
      console.log("checked", { removeAnnotation });
      const outputValue = formatModelica({ moCode: inputTxtValue, removeAnnotation: removeAnnotationValue });
      document.getElementById("output").innerHTML = outputValue;
    });
  </script>
</html>
